{"version":3,"sources":["../src/index.ts"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["import * as musique from \"musique\";\r\nimport {AlbumOutput, SongOutput, SongParser} from \"musique\";\r\nimport * as Promise from \"bluebird\";\r\nimport * as readline from \"readline\";\r\nimport * as async from \"async\";\r\nimport * as mkdirp from \"mkdirp\";\r\nimport * as ProgressBar from \"progress\";\r\nimport * as fs from \"fs\";\r\nimport * as request from \"request\";\r\nimport * as Jimp from \"jimp\";\r\nimport * as program from \"commander\";\r\n\r\nconst nodeID3v23 = require(\"node-id3\");\r\nconst nodeID3v24 = require(\"node-id3v2.4\");\r\n\r\nfunction downloadSong(songUrl: string): Promise<void> {\r\n    let platformName: \"deezer\" | \"saavn\";\r\n\r\n    if (songUrl.includes(\"deezer\")) {\r\n        platformName = \"deezer\";\r\n    } else if (songUrl.includes(\"saavn\")) {\r\n        platformName = \"saavn\";\r\n    }\r\n\r\n    let songParser: SongParser,\r\n        songTitle: string,\r\n        songTrack: string,\r\n        songArtists: string,\r\n        albumDate: string,\r\n        albumLabel: string,\r\n        albumLanguage: string,\r\n        albumTitle: string,\r\n        albumArtists: string,\r\n        directoryName: string,\r\n        mp3FileName: string,\r\n        artFileName: string;\r\n\r\n    return new Promise<void>((resolve, reject) => {\r\n        console.log(\"Starting...\");\r\n        console.log(\"\");\r\n\r\n        musique.parseSong(platformName!, songUrl)\r\n            .then(parser => parser.parse())\r\n            .then(parser => parser.parseAlbum(childParser => childParser.parse()))\r\n            .then(parser => {\r\n                songParser = parser;\r\n\r\n                let songOutput: SongOutput = parser.output,\r\n                    albumOutput: AlbumOutput = songOutput.album;\r\n\r\n                songTitle = songOutput.title;\r\n                songTrack = songOutput.track;\r\n                songArtists = [...new Set(songOutput.artists.map(artist => artist.title))].join(\"; \");\r\n                albumDate = albumOutput.date;\r\n                albumLabel = albumOutput.label;\r\n                albumLanguage = albumOutput.language;\r\n                albumTitle = albumOutput.title;\r\n                albumArtists = [...new Set(albumOutput.artists.map(artist => artist.title))].join(\"; \");\r\n\r\n                songArtists = songArtists.replace(/\\.(\\w)/g, \". $1\");\r\n                albumArtists = albumArtists.replace(/\\.(\\w)/g, \". $1\");\r\n\r\n                resolve();\r\n            })\r\n            .catch(error => {\r\n                reject(error);\r\n            });\r\n    })\r\n        .then(() => {\r\n            return new Promise<void>(resolve => {\r\n                console.log(\"Song title: \" + songTitle);\r\n                console.log(\"Album title: \" + albumTitle);\r\n                console.log(\"Song artists: \" + songArtists);\r\n                console.log(\"Album artists: \" + albumArtists);\r\n                console.log(\"Song track: \" + songTrack);\r\n                console.log(\"Album date: \" + albumDate);\r\n                console.log(\"Album label: \" + albumLabel);\r\n                console.log(\"Album language: \" + albumLanguage);\r\n                console.log(\"\");\r\n\r\n                let rl = readline.createInterface({\r\n                    input: process.stdin,\r\n                    output: process.stdout\r\n                });\r\n\r\n                rl.question(\"Update? (no) \", answer => {\r\n                    console.log(\"\");\r\n\r\n                    if (answer === \"y\" || answer === \"yes\") {\r\n                        async.series([\r\n                            callback => {\r\n                                rl.question(\"Song title: (\" + songTitle + \") \", answer => {\r\n                                    if (answer) {\r\n                                        songTitle = answer;\r\n                                    }\r\n\r\n                                    callback();\r\n                                });\r\n                            }, callback => {\r\n                                rl.question(\"Album title: (\" + albumTitle + \") \", answer => {\r\n                                    if (answer) {\r\n                                        albumTitle = answer;\r\n                                    }\r\n\r\n                                    callback();\r\n                                });\r\n                            }, callback => {\r\n                                rl.question(\"Song artists: (\" + songArtists + \") \", answer => {\r\n                                    if (answer) {\r\n                                        songArtists = answer;\r\n                                    }\r\n\r\n                                    callback();\r\n                                });\r\n                            }, callback => {\r\n                                rl.question(\"Album artists: (\" + albumArtists + \") \", answer => {\r\n                                    if (answer) {\r\n                                        albumArtists = answer;\r\n                                    }\r\n\r\n                                    callback();\r\n                                });\r\n                            }, callback => {\r\n                                rl.question(\"Song track: (\" + songTrack + \") \", answer => {\r\n                                    if (answer) {\r\n                                        songTrack = answer;\r\n                                    }\r\n\r\n                                    callback();\r\n                                });\r\n                            }, callback => {\r\n                                rl.question(\"Album date: (\" + albumDate + \") \", answer => {\r\n                                    if (answer) {\r\n                                        albumDate = answer;\r\n                                    }\r\n\r\n                                    callback();\r\n                                });\r\n                            }, callback => {\r\n                                rl.question(\"Album label: (\" + albumLabel + \") \", answer => {\r\n                                    if (answer) {\r\n                                        albumLabel = answer;\r\n                                    }\r\n\r\n                                    callback();\r\n                                });\r\n                            }, callback => {\r\n                                rl.question(\"Album language: (\" + albumLanguage + \") \", answer => {\r\n                                    if (answer) {\r\n                                        albumLanguage = answer;\r\n                                    }\r\n\r\n                                    callback();\r\n                                });\r\n                            }\r\n                        ], () => {\r\n                            rl.close();\r\n\r\n                            console.log(\"\");\r\n\r\n                            resolve();\r\n                        });\r\n                    } else {\r\n                        rl.close();\r\n\r\n                        resolve();\r\n                    }\r\n                });\r\n            });\r\n        })\r\n        .then(() => {\r\n            directoryName = \"Songs/\"\r\n                + albumLanguage + \"/\"\r\n                + albumDate.substr(0, 4) + \"/\"\r\n                + albumTitle + \"/\";\r\n            directoryName = directoryName.replace(/[\\\\:*?\"<>|]/g, \"\");\r\n\r\n            return new Promise<void>((resolve, reject) => {\r\n                mkdirp(directoryName, error => {\r\n                    if (error) {\r\n                        reject(error);\r\n                        return;\r\n                    }\r\n\r\n                    resolve();\r\n                });\r\n            });\r\n        })\r\n        .then(() => {\r\n            mp3FileName = directoryName + songTrack + \" - \" + songTitle + \".mp3\";\r\n            mp3FileName = mp3FileName.replace(/[\\\\:*?\"<>|]/g, \"\");\r\n\r\n            return new Promise<void>((resolve, reject) => {\r\n                let progress: any, progressBar: ProgressBar;\r\n\r\n                let megaBytes = function (bytes: number) {\r\n                    return Math.round(bytes / 1024 / 1024 * 10) / 10;\r\n                };\r\n\r\n                songParser.parseFile(state => {\r\n                    if (!progress) {\r\n                        progress = state;\r\n                        progress.size.downloaded = 0;\r\n\r\n                        progressBar = new ProgressBar(\"Downloading... [:bar] :percent :speed :size :time\", {\r\n                            total: progress.size.total,\r\n                            width: 10,\r\n                            head: \">\",\r\n                            incomplete: \" \",\r\n                            renderThrottle: 100\r\n                        });\r\n                    }\r\n\r\n                    progressBar.tick(progress.size.transferred - progress.size.downloaded, {\r\n                        speed: megaBytes(progress.speed) + \"MBps\",\r\n                        size: megaBytes(progress.size.transferred) + \"/\" + megaBytes(progress.size.total) + \"MB\",\r\n                        time: progress.time.remaining + \"s\"\r\n                    });\r\n\r\n                    progress.size.downloaded = progress.size.transferred;\r\n                })\r\n                    .then(parser => {\r\n                        fs.writeFile(mp3FileName, parser.output.file, error => {\r\n                            if (error) {\r\n                                reject(error);\r\n                                return;\r\n                            }\r\n\r\n                            progressBar.tick(progress.size.total, {\r\n                                speed: megaBytes(progress.speed) + \"MBps\",\r\n                                size: megaBytes(progress.size.total) + \"/\" + megaBytes(progress.size.total) + \"MB\",\r\n                                time: \"0s\"\r\n                            });\r\n\r\n                            resolve();\r\n                        });\r\n                    })\r\n                    .catch(error => {\r\n                        reject(error);\r\n                    });\r\n            });\r\n        })\r\n        .then(() => {\r\n            artFileName = directoryName + songTrack + \" - \" + songTitle + \".png\";\r\n            artFileName = artFileName.replace(/[\\\\:*?\"<>|]/g, \"\");\r\n\r\n            return new Promise<void>((resolve, reject) => {\r\n                request(songParser.output.album.art)\r\n                    .on(\"error\", error => {\r\n                        reject(error);\r\n                    })\r\n                    .pipe(fs.createWriteStream(artFileName))\r\n                    .on(\"finish\", () => {\r\n                        Jimp.read(artFileName)\r\n                            .then(image => {\r\n                                image.resize(512, 512, Jimp.RESIZE_NEAREST_NEIGHBOR)\r\n                                    .write(artFileName, error => {\r\n                                        if (error) {\r\n                                            reject(error);\r\n                                            return;\r\n                                        }\r\n\r\n                                        resolve();\r\n                                    });\r\n                            })\r\n                            .catch(error => {\r\n                                reject(error);\r\n                            });\r\n                    });\r\n            });\r\n        })\r\n        .then(() => {\r\n            nodeID3v23.removeTags(mp3FileName);\r\n\r\n            nodeID3v23.write({\r\n                album: albumTitle,\r\n                artist: songArtists,\r\n                image: artFileName,\r\n                language: albumLanguage,\r\n                performerInfo: albumArtists,\r\n                publisher: albumLabel,\r\n                title: songTitle,\r\n                trackNumber: songTrack\r\n            }, mp3FileName);\r\n\r\n            let tag = nodeID3v24.readTag(mp3FileName);\r\n            tag.addFrame(\"TDRC\", [albumDate]);\r\n            tag.addFrame(\"TDRL\", [albumDate]);\r\n            tag.write();\r\n        })\r\n        .then(() => {\r\n            return new Promise<void>((resolve, reject) => {\r\n                fs.unlink(artFileName, error => {\r\n                    if (error) {\r\n                        reject(error);\r\n                        return;\r\n                    }\r\n\r\n                    console.log(\"\");\r\n                    console.log(\"Completed!\");\r\n\r\n                    resolve();\r\n                });\r\n            });\r\n        });\r\n}\r\n\r\nprogram\r\n    .option(\"-u, --url [url]\")\r\n    .parse(process.argv);\r\n\r\ndownloadSong(program.url)\r\n    .catch(error => {\r\n        console.error(error);\r\n    });\r\n"]}